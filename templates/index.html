<!doctype html>
<html>
  <head>
    <title>Drone</title>
   <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/mystyle.css') }}"> 
  </head>
  
  <script>
     var socket = new WebSocket('ws://' + location.host + '/action');
     var difficulty = 'Not set';

     socket.addEventListener('open', function (event) {
	     console.log("[open] Connection established");
     });

     socket.addEventListener('message', function (event) {
	     var data = JSON.parse(event.data);
	     if (data.action == 'score') {
		     document.getElementById('score').textContent = + data.value + " KR";
	     }

       if (data.action == 'goal') {
        document.getElementById('alertText').innerHTML = data.message;
        document.getElementById('customAlert').style.display = 'block';
      }

    if (data.action == 'select_location') {
  // Show the modal
  var modal = document.getElementById("myModal");
  modal.style.display = "block";

  // Set the checkpoint name
  var checkpoint = document.getElementById("checkpoint");
  checkpoint.textContent = "Next destination is checkpoint " + data.destination_name + ".";

  // Get the buttons and add click events
  var btns = document.getElementsByClassName("choice-btn");
  for (var i = 0; i < btns.length; i++) {
    btns[i].onclick = function(e) {
      // Send the user's choice back to the server
      var choice = e.target.value;
      socket.send(JSON.stringify({ action: 'select_location_choice', choice: choice }));

    // Store the hexagoncolor
    hexagon_color = choice == 'easy' ? 'green' : 'red';

// Update the difficulty display
    document.getElementById('difficultyDisplay').textContent = "You have chosen the " + hexagon_color+ " hexagon for checkpoint "+data.destination_name;


      // Hide the modal
      modal.style.display = "none";
    }
  }
}

    
     });
     function sendText(button) {
      var text = button.value; // Get the value of the button
      var message = JSON.stringify({ action: text }); // Convert to JSON
      socket.send(message); // Send the text to the server
      // Get all buttons
      var buttons = document.querySelectorAll("button");

      // Add a 'hide' class to all buttons
      buttons.forEach(function(btn) {
        btn.classList.add("hide");
      });

      // Remove the 'hide' class after 1 second
      setTimeout(function() {
        buttons.forEach(function(btn) {
          btn.classList.remove("hide");
        });
      }, 1000);
          }
   </script>
  <body>
<div id="log"></div>
    <br>

    <div class="container">
      <div class="button-container">
      <h1>Drone Controller</h1>
      <div class="score">
        <h2 id="score">0 KR</h2>
       
        </div>
      </div>
      <div><button class="btn" value="forward" onclick="sendText(this)">Forward</button></div>
      <div class="button-container">
    <button class="btn" value="left" onclick="sendText(this)">Left</button>
  <button class="btn" value="right" onclick="sendText(this)">Right</button>
  </div>
  <div>
  <button class="btn" value="back" onclick="sendText(this)">Back</button>
</div>
  
 

</div>

<div class="container">
  <div class="button-container2" id="btn2-container">
  <button class="btnTO" value="take off" onclick="sendText(this)">Take off</button>
  <button class="btn2" value="land" id="landBtn" onclick="sendText(this)">Land</button>
  <span id="difficultyDisplay">Difficulty not set</span>
</div>

<div id="myModal" class="modal">
  <div class="modal-content">
    <h2 id="checkpoint"></h2>
    <p>Do you want to fly through the hard (small) or easy (big) loop?</p>
    <button class="choice-btn" value="easy">Easy</button>
    <button class="choice-btn" value="hard">Hard</button>
  </div>
</div>

  <!-- The custom alert box -->
  <div id="customAlert" class="custom-alert">
   
    <div class="custom-alert-content">
      <p id="alertText"></p>
      <button onclick="document.getElementById('customAlert').style.display='none'">OK</button>
    </div>
    
  </div>




  


     </body>
    
    
</html>
